# Charts repository
%if "%_repository" == "charts"
Type: helm
Repotype: none
Patterntype: none
Required: perl-YAML-LibYAML
%endif

%if "%_repository" == "containerkiwi"
Type: kiwi
Repotype: slepool:nobuildid
Patterntype: none
%endif

# Container images are build in 'containers' repository
# ISO images are build in 'containers' repository too
%if %_repository == "containers"
Required: elemental-post-build-extract-iso
Repotype: staticlinks

Type: docker
BuildEngine: docker

# Fix a choice between docker-stable-buildx
Prefer: docker-buildx

# Docker requires the default kernel otherwise it fails applying iptables
Required: kernel-default
Prefer: SL-Micro-release

Prefer: registries-conf-suse
%endif

%if %_repository == "containers" || "%_repository" == "charts"
Macros:
%img_repo %(echo registry.opensuse.org:%{_project}:containers | tr ":" "/" | tr '[:upper:]' '[:lower:]')
%slmicro_version 6.2
:Macros

BuildFlags: dockerarg:SLMICRO_VERSION=6.2
BuildFlags: dockerarg:SL_VERSION=16.0
%endif
