# Charts repository
%if "%_repository" == "charts"
Type: helm
Repotype: none
Patterntype: none
Required: perl-YAML-LibYAML
%endif

%if "%_repository" == "containerkiwi"
Type: kiwi
Repotype: slepool:nobuildid
Patterntype: none
%endif

# Container images are build in 'containers' repository
# ISO images are build in 'containers' repository too
%if %_repository == "containers"
Required: elemental-post-build-extract-iso
Repotype: staticlinks

%ifarch aarch64
# Configuration for the RPi image
Required: elemental-post-build-generate-rpi-image
Macros:
# RPi seed image size in MB
%img_size 1280
:Macros
%endif

Type: docker
BuildEngine: docker

Prefer: registries-conf-suse
Prefer: kernel-default
%endif

%if %_repository == "containers" || "%_repository" == "charts"
Macros:
%img_repo %(echo registry.opensuse.org:%{_project}:containers | tr ":" "/" | tr '[:upper:]' '[:lower:]')
%slmicro_version 6.1
:Macros

BuildFlags: dockerarg:SLMICRO_VERSION=6.1
%endif

# Fix choice (go1.22 vs go1.22-openssl) for helm
Prefer: go1.22

# Fix choice for elemental-toolkit
# For some unexpected reason it is not pulling go1.23...
Prefer: go1.24
